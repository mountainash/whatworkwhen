function updateClock(){var t=moment(),e=6*t.seconds(),s=6*t.minutes()+e/60,o=t.hours()%12/12*360+90+s/12;if($("#clock-hour").css("transform",`rotate(${o}deg)`),$("#clock-minute").css("transform",`rotate(${s}deg)`),$("#clock-second").css("transform",`rotate(${e}deg)`),$("#digital-hour").text(`0${t.hours()}`.slice(-2)),$("#digital-minute").text(`0${t.minutes()}`.slice(-2)),$("#digital-second").text(`0${t.seconds()}`.slice(-2)),(0==t.seconds()||nexttask.start-t<6e4)&&minUpdate(),t>=nexttask.start){if("Notification"in window){var n=`Start ${nexttask.title}`,i="apple-touch-icon.png";try{new Notification("What Work When",{body:n,icon:i}),window.navigator.vibrate(500)}catch(t){alert(n)}}location.reload()}}function minUpdate(){$("#info").text(`Starts in ${nexttask.start.fromNow(!0)}`)}function secUpdate(){updateClock(),setTimeout(secUpdate,1e3)}function requestPermission(){"Notification"in window?Notification.requestPermission().then(function(t){console.info(`Local Notifications: ${t}`)}):console.warn("Local Notifications not supported!")}var nexttask;fetch("schedule.json",{priority:"high"}).then(t=>{if(!t.ok)throw new Error(`HTTP error, status = ${t.status}`);return t.json()}).then(t=>{var e=t.day.end;$.each(t.tasks,function(s,o){if(!/\d{4}/.test(o.start))return console.error(`Task ${s} can only be 4 digits. "${o.start}" is not allowed`),!1;if(parseInt(o.start)<0||parseInt(o.start)>2400)return console.error(`Task ${s} is not a valid 24 hour time. "${o.start}" is not allowed`),!1;$("#instructions").remove();var n=o.start,i=n.split(/(\d{2})/),a=moment().hour(i[1]).minute(i[3]).second(0),r=e,c="";t.tasks[s+1]&&(r=t.tasks[s+1].start);var d=r.split(/(\d{2})/),l=moment().hour(d[1]).minute(d[3]);moment().isBetween(a,l)?c="now":"now"==c&&(c="soon");var u=$("#tasks li").first().clone();u.find(".name").text(o.title),u.find(".stime").text(n),u.find(".etime").text(r),u.addClass(c).appendTo("#tasks ol"),"soon"===c&&(nexttask=o,nexttask.start=a,$("#tasks li").last().append(`<span id="info">Starts in ${nexttask.start.fromNow(!0)}</span>`))}),$("#tasks li").first().remove(),secUpdate()}),requestPermission();