function updateClock(){var t=moment(),e=6*t.seconds(),s=6*t.minutes()+e/60,o=t.hours()%12/12*360+90+s/12;if($("#clock-hour").css("transform",`rotate(${o}deg)`),$("#clock-minute").css("transform",`rotate(${s}deg)`),$("#clock-second").css("transform",`rotate(${e}deg)`),$("#digital-hour").text(`0${t.hours()}`.slice(-2)),$("#digital-minute").text(`0${t.minutes()}`.slice(-2)),$("#digital-second").text(`0${t.seconds()}`.slice(-2)),(0==t.seconds()||nexttask.start-t<6e4)&&minUpdate(),t>=nexttask.start){if("Notification"in window){var n=`Start ${nexttask.title}`,a="apple-touch-icon.png";try{new Notification("What Work When",{body:n,icon:a}),window.navigator.vibrate(500)}catch(t){alert(n)}}location.reload()}}function minUpdate(){$("#info").text(`Starts in ${nexttask.start.fromNow(!0)}`)}function secUpdate(){updateClock(),setTimeout(secUpdate,1e3)}function requestPermission(){"Notification"in window?Notification.requestPermission().then(function(t){console.info(`Local Notifications: ${t}`)}):console.warn("Local Notifications not supported!")}var nexttask={title:"Day is over - go play! ðŸŽ‰",start:null};fetch("schedule.json",{priority:"high"}).then(t=>{if(!t.ok)throw new Error(`HTTP error, status = ${t.status}`);return t.json()}).then(t=>{var e=t.day.end,s="";$.each(t.tasks,function(o,n){if(!/\d{4}/.test(n.start))return console.error(`Task ${o} can only be 4 digits. "${n.start}" is not allowed`),!1;if(parseInt(n.start)<0||parseInt(n.start)>2400)return console.error(`Task ${o} is not a valid 24 hour time. "${n.start}" is not allowed`),!1;$("#instructions").remove();var a=n.start,i=a.split(/(\d{2})/),r=moment().hour(i[1]).minute(i[3]).second(0),c=e;t.tasks[o+1]&&(c=t.tasks[o+1].start);var l=c.split(/(\d{2})/),d=moment().hour(l[1]).minute(l[3]).second(0);nexttask.start=d,s=moment().isBetween(r,d)?"now":"now"==s?"soon":"later";var u=$("#tasks li").first().clone();$(".name",u).text(n.title),$(".stime",u).text(a),$(".etime",u).text(c),"soon"===s&&(nexttask=n,nexttask.start=r,u.append(`<span id="info">Starts in ${nexttask.start.fromNow(!0)}</span>`)),u.addClass(s).appendTo("#tasks ol")}),$("#tasks li").first().remove(),secUpdate()}),requestPermission();