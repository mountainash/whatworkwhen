function updateClock(){var t=moment(),e=6*t.seconds(),o=6*t.minutes()+e/60,s=t.hours()%12/12*360+90+o/12;if($("#clock-hour").css("transform",`rotate(${s}deg)`),$("#clock-minute").css("transform",`rotate(${o}deg)`),$("#clock-second").css("transform",`rotate(${e}deg)`),$("#digital-hour").text(`0${t.hours()}`.slice(-2)),$("#digital-minute").text(`0${t.minutes()}`.slice(-2)),$("#digital-second").text(`0${t.seconds()}`.slice(-2)),(0==t.seconds()||nexttask.start-t<6e4)&&minUpdate(),t>=nexttask.start){if("Notification"in window){var n=`Start ${nexttask.title}`,i="apple-touch-icon.png";try{new Notification("What Work When",{body:n,icon:i}),window.navigator.vibrate(500)}catch(t){alert(n)}}location.reload()}}function minUpdate(){$("#info").text(`Starts in ${nexttask.start.fromNow(!0)}`)}function secUpdate(){updateClock(),setTimeout(secUpdate,1e3)}function requestPermission(){"Notification"in window?Notification.requestPermission().then(function(t){console.info(`Local Notifications: ${t}`)}):console.warn("Local Notifications not supported!"),$("#activate-notifications").hide()}var nexttask={title:"Day is over - go play! ðŸŽ‰",start:null};fetch("schedule.json",{priority:"high"}).then(t=>{if(!t.ok)throw new Error(`HTTP error, status = ${t.status}`);return t.json()}).then(t=>{var e=t.day.end,o="";$.each(t.tasks,function(s,n){if(!/\d{4}/.test(n.start))return console.error(`Task ${s} can only be 4 digits. "${n.start}" is not allowed`),!1;if(parseInt(n.start)<0||parseInt(n.start)>2400)return console.error(`Task ${s} is not a valid 24 hour time. "${n.start}" is not allowed`),!1;$("#instructions").remove();var i=n.start,a=i.split(/(\d{2})/),r=moment().hour(a[1]).minute(a[3]).second(0),c=e;t.tasks[s+1]&&(c=t.tasks[s+1].start);var d=c.split(/(\d{2})/),l=moment().hour(d[1]).minute(d[3]).second(0);nexttask.start=l,o=moment().isBetween(r,l)?"now":"now"==o?"soon":"later";var u=$("#tasks li").first().clone();$(".name",u).text(n.title),$(".stime",u).text(i),$(".etime",u).text(c),"soon"===o&&(nexttask=n,nexttask.start=r,u.append(`<span id="info">Starts in ${nexttask.start.fromNow(!0)}</span>`)),u.addClass(o).appendTo("#tasks ol")}),$("#tasks li").first().remove(),secUpdate()}),"?ref=webappmanifest"===window.location.search&&"Notification"in window&&$("#activate-notifications").show().on("click",function(){return requestPermission(),!1}),requestPermission();