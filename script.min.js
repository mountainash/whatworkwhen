var nexttask={title:"Day is over - go play! ðŸŽ‰",start:null};function updateClock(){var t=moment(),n=6*t.seconds(),o=6*t.minutes()+n/60,i=t.hours()%12/12*360+90+o/12;if($("#clock-hour").css("transform",`rotate(${i}deg)`),$("#clock-minute").css("transform",`rotate(${o}deg)`),$("#clock-second").css("transform",`rotate(${n}deg)`),$("#digital-hour").text(("0"+t.hours()).slice(-2)),$("#digital-minute").text(("0"+t.minutes()).slice(-2)),$("#digital-second").text(("0"+t.seconds()).slice(-2)),(0==t.seconds()||nexttask.start-t<6e4)&&minUpdate(),t>=nexttask.start){if("Notification"in window){i="Start "+nexttask.title;try{new Notification("What Work When",{body:i,icon:"apple-touch-icon.png"}),window.navigator.vibrate(500)}catch(t){alert(i)}}location.reload()}}function minUpdate(){$("#info").text("Starts in "+nexttask.start.fromNow(!0))}function secUpdate(){updateClock(),setTimeout(secUpdate,1e3)}function requestPermission(){"Notification"in window?Notification.requestPermission().then(function(t){console.info("Local Notifications: "+t)}):console.warn("Local Notifications not supported!"),$("#activate-notifications").hide()}fetch("schedule.json",{priority:"high"}).then(t=>{if(t.ok)return t.json();throw new Error("HTTP error, status = "+t.status)}).then(a=>{var s=a.day.end,r="";$.each(a.tasks,function(t,n){if(!/\d{4}/.test(n.start))return console.error(`Task ${t} can only be 4 digits. "${n.start}" is not allowed`),!1;if(parseInt(n.start)<0||2400<parseInt(n.start))return console.error(`Task ${t} is not a valid 24 hour time. "${n.start}" is not allowed`),!1;$("#instructions").remove();var o=n.start,i=moment(o,"hhmm"),e=s,t=(a.tasks[t+1]&&(e=a.tasks[t+1].start),moment(e,"hhmm")),t=(nexttask.start=t,r=moment().isBetween(i,t)?"now":"now"==r?"soon":"later",$("#tasks li").first().clone());$(".name",t).text(n.title),$(".stime",t).text(o),$(".etime",t).text(e),"soon"===r&&((nexttask=n).start=i,t.append(`<span id="info">Starts in ${nexttask.start.fromNow(!0)}</span>`)),t.addClass(r).appendTo("#tasks ol")}),$("#tasks li").first().remove(),secUpdate()}),"?ref=webappmanifest"===window.location.search&&"Notification"in window&&$("#activate-notifications").show().on("click",function(){return requestPermission(),!1}),requestPermission();